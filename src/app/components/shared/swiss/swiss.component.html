<!-- begin main content -->
<div class="swiss">
  <div class="swiss-container">
    <div class="rounds">
      <div class="round" *ngFor="let round of rounds; let i = index">
        <h3>{{ locale.t.label.round }} {{ i + 1 }}</h3>
        <div class="matches">
          <div
            class="match"
            [class.c-pointer]="!readonly"
            [class.pointer-events-none]="readonly"
            (click)="openManageGamesModal(i, j)"
            *ngFor="let match of round.matches; let j = index"
          >
            <div class="wrapper">
              <div
                class="participant badge"
                [class.bg-primary]="match.won === match.p1"
                [class.bg-secondary]="match.lost === match.p1"
              >
                {{ getParticipant(match.p1) }}
              </div>
              <div class="vs">vs</div>
              <div
                class="participant badge"
                [class.bg-primary]="match.won === match.p2"
                [class.bg-secondary]="match.lost === match.p2"
              >
                {{ getParticipant(match.p2) }}
              </div>
            </div>
            <div class="games">
              <div class="game" *ngFor="let game of match.games; let i = index">
                <span>{{ locale.t.label.game }} {{ i + 1 }}</span>
                <span
                  class="badge"
                  [class.bg-primary]="shouldHighlight(match, game)"
                  [class.bg-secondary]="!shouldHighlight(match, game)"
                >
                  {{ getGame(game) }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- end main content -->

<!-- begin fab -->
<app-fab icon="fa fa-table" (onClick)="openStandingsModal()"></app-fab>
<!-- end fab -->

<!-- begin standings modal -->
<app-modal
  [header]="locale.t.header.standings"
  [show]="isStandingsModalVisible"
  (close)="closeStandingsModal()"
>
  <div modal-body>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th class="text-center fit-content">#</th>
          <th>Team</th>
          <th class="text-center">Matches</th>
          <th class="text-center">Rounds</th>
          <th class="text-center">RD</th>
          <th class="text-center">BU</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of standings; let i = index">
          <th class="t-col-fit text-center">{{ i + 1 }}</th>
          <td>
            {{ getParticipant(item.name) }}
          </td>
          <td class="text-center">{{ item.wins }}-{{ item.losses }}</td>
          <td class="text-center">
            {{ getScore(item.name).won }} - {{ getScore(item.name).lost }}
          </td>
          <td class="text-center">{{ item.diff }}</td>
          <td class="text-center">{{ item.buchholz }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</app-modal>
<!-- end standings modal -->

<!-- begin manage modal -->
<app-modal
  [header]="gameHeader"
  [show]="isManageGamesModalVisible"
  (close)="closeManageGamesModal()"
>
  <div modal-body>
    <ul class="list-group mb-3">
      <li
        *ngFor="let game of currentGames; let i = index"
        class="list-group-item"
      >
        <div class="d-flex flex-column">
          <!-- Label Row -->
          <div class="mb-2">
            <strong>{{ locale.t.label.game }} {{ i + 1 }}</strong>
          </div>
          <!-- Inputs and Button Row -->
          <div class="d-flex align-items-center justify-content-between">
            <!-- Inputs -->
            <div class="d-flex gap-2 flex-grow-1">
              <input
                type="number"
                [(ngModel)]="game.p1"
                class="form-control"
                placeholder="Player 1"
              />
              <input
                type="number"
                [(ngModel)]="game.p2"
                class="form-control"
                placeholder="Player 2"
              />
            </div>
            <!-- Button -->
            <button class="btn btn-danger ms-3" (click)="removeGame(i)">
              {{ locale.t.action.delete }}
            </button>
          </div>
        </div>
      </li>
    </ul>
  </div>

  <div modal-footer>
    <button class="btn btn-secondary btn-sm" (click)="addGame()">
      {{ locale.t.action.add }}
    </button>
    <button class="btn btn-primary btn-sm ms-2" (click)="saveGames()">
      {{ locale.t.action.save }}
    </button>
  </div>
</app-modal>
<!-- end manage modal -->
